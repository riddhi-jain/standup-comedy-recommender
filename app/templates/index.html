{% extends "base.html" %}

{% block content %}


<div class="container col-lg-8">
    <div id="titleBlock">
    <h2>Standup Comedy Recommender</h2>
    <small>Created by Stephen Kaplan (stevejkaplan@gmail.com)</small>
    <p style="margin-top:10px;">
        This standup-comedy recommender is 100% powered by Natural Language Processing (NLP) techniques & unsupervised
        machine learning algorithms. (In other words, none of the topics assigned to each comedy special were hard-coded -
        they were algorithmically generated using machine learning). This project was created over a 2-week span during my time at the
        <a href="https://www.thisismetis.com/" target="_blank">Metis</a> data science program.
    </p>
      <p style="padding-top: 10px; ">
        <a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
          Technical Details
        </a>
      </p>
      <div class="collapse" id="collapseExample">
        <div style="margin-bottom: 20px;" class="card card-body">

            <h6>Data Acquisition & Storage</h6>
            <p>
                The initial data source is a <a href=" https://scrapsfromtheloft.com/stand-up-comedy-scripts/" target="_blank">set of stand-up comedy transcripts</a>
                published on "Scraps from the Loft". I used <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank">Beautiful Soup</a> to
                scrape the transcripts. The raw text was then processed and stored in a
                <a href="https://www.mongodb.com/" target="_blank">Mongo</a> database hosted
                remotely on an <a href="https://aws.amazon.com/ec2/" target="_blank">AWS EC2</a> instance.
            </p>

            <h6>NLP Processing Pipeline</h6>
            <p>
                Each raw comedy transcript was processed with the following pipeline:
                <ul>
                    <li>Initial baseline cleaning of text to remove punctuation and non-meaningful anomalies.</li>
                    <li>
                        Removal of stop words (including scikit-learn's predefined set of
                        <a href="https://scikit-learn.org/stable/modules/feature_extraction.html#stop-words" target="_blank">stop words</a>
                        as well as a manually defined list of words.
                    </li>
                    <li>
                        Lemmatization using <a href="https://www.nltk.org/_modules/nltk/stem/wordnet.html" target="_blank">NLTK</a>
                    </li>
                    <li>
                        Vectorized using scikit-learn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" target="_blank">TFIDF Vectorizer</a>.
                    </li>
                </ul>
            </p>

            <h6>Machine Learning Algorithms (Topic Modeling & Recommender)</h6>
            <p>
                The filter topics were generated by reducing the dimensions of the TFIDF-Vectorized data using an
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html" target="_blank">NMF decomposition</a>.
                The topic names were assigned by manually reviewing the top words associated with each topic.

                The search/recommender feature takes the user-provided text, puts it in the same TFIDF variable space as the original corpus using the pre-trained
                NLP Pipeline described above. Then, the text is transformed into the same topic space as the corpus using the pre-trained NMF model.
                Finally,
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html">cosine similarity</a>
                is calculated between the search term topic space and the topic space for every document in the corpus. Those similarities are ranked, and
                the top 10 most similar comedy specials are displayed as a recommendation.
            </p>

            <h6>Additional Details</h6>

            <p>This application was written using <a href="https://flask.palletsprojects.com/en/1.1.x/" target="_blank">Flask</a>.</p>
            <p>
            The source code for this project can be found <a href="https://github.com/stephenjkaplan/standup-comedy-recommender" target="_blank">here</a>.
            </p>



        </div>
    </div>


      </div>
    <div class="container row search-bar">
        <span id="description">
            <b>Type in some key words/topics that describe the comedy you'd like to watch or use the topic filter (or both).</b>

        </span>
        <div class="container col-lg-8">
                <form action="/search" autocomplete="off" class="form-horizontal" method="post" accept-charset="utf-8">
                  <div class="form-group">
                    <input class="form-control" type="search" placeholder="Search" aria-label="Search" name="search" value="{{ search_text }}">
                  </div>
                </form>
        </div>
        <div class="container col">

            <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span id="displayOption">Filter By Topic</span>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    {% for option in dropdown_options %}
                    <a class="dropdown-item" data-option="{{ loop.index0 }}">{{ option }}</a>
                    {% endfor %}

            </div>
        </div>
    </div>
    </div>

    <div id="recommendations" style="margin-left:15px;">
        <div class="row" id="comedyCards">
            {% for info in comedy_info %}
            <div class="card" style="width: 13rem; margin: 5px;"
                 data-topic-0="{{ info[6] }}" data-topic-1="{{ info[7] }}" data-topic-2="{{ info[8] }}"
                 data-topic-3="{{ info[9] }}" data-topic-4="{{ info[10] }}" data-topic-5="{{ info[11] }}">
                <img src="{{ info[5] }}" height="280px" style="padding:5px;" alt="{{ info[3] }}">
                <div class="card-body">
                    <h6 class="card-text">{{ info[2] }}</h6>
                    <p>
                        <small>{{ info[3] }}</small><br>
                        <small>({{ info[4] }})</small>
                    </p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

</div>



{% endblock %}